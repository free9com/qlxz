
# 外协工单系统
qwen code生成
## 项目概述

这是一个基于微信小程序的外协工单管理系统，采用BBS论坛形式组织，每个合同对应一个分论坛。系统支持工单的全生命周期管理，从创建、分配、执行到验收的完整流程。

## 系统架构

- **前端**: 微信小程序（负责用户交互、拍照上传、工单查看等功能）
- **后台管理**: Web端（用于合同配置、流程设置、数据管理等）
- **后端服务**: 使用现代流行且相对简单的框架构建
- **数据库**: Supabase
- **部署**: 各组件独立Docker容器化部署

## 核心功能流程

### 1. 维修工单创建
- 班长在对应合同分论坛发帖报告起重机故障
- 无需额外收费：直接生成工单
- 需要额外收费：系统生成设备外协维修改造任务审批单，启动多级审批流程
  - 使用部门经理 → 实施部门经理 → 分管领导 → 总经理

### 2. 工单类型
系统支持三种类型的工单：

#### 定时保养工单
- 在合同开始时设定定期日期
- 到期自动生设备外协维修改造任务单

#### 故障维修工单
- 由班长在论坛发帖直接生成

#### 审批通过工单
- 由审批通过的维修改造任务审批单生成

所有工单均需外协维修人员主动领单，但是需要提醒项目联络人，由联络人手工提醒。

### 3. 工作执行与记录
所有工单执行过程中需满足以下要求：
- 小程序调用摄像头拍摄关键步骤照片
- 计时收费项目需拍摄进场、出场照片
- 更换配件需提供配件资料
- 所有附件自动加入工程量确认单
- 工程量确认单需外协项目经理和甲方现场负责人共同签认

### 4. 工作验收
验收流程根据项目重要性分级：
- 普通项目：现场负责人 + 部门经理签认
- 重大或高风险项目：增加副总签认环节

### 5. 通知与沟通
- 小程序自动生成各项通知的图文资料
- 由项目联系人或班长通过微信发送通知

## 技术特性

### 流程引擎
- 参考Camunda实现审批流程
- 支持退回上一步、退回到开始等灵活处理机制

### 配置管理
- 各合同所需的表格模板可在Web后台灵活设置
- 审批流程可自定义配置

## 数据存储
- 符合特定格式的消息（以@bot开头）将被写入数据库
- 支持帖子和回帖的数据持久化

## 部署方式
- 前台(微信小程序)、后台(Web)、后端、数据库均采用独立Docker容器部署
- 后端使用Supabase作为数据库服务
- 技术栈选择流行且相对简单的框架，便于开发和维护
